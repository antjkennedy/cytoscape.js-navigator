!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i=e();for(var o in i)("object"==typeof exports?exports:t)[o]=i[o]}}(this,function(){return function(t){function e(o){if(i[o])return i[o].exports;var n=i[o]={exports:{},id:o,loaded:!1};return t[o].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){!function(){function e(t,e){if(t||(t=window.jQuery),e||(e=window.cytoscape),!t)throw new ReferenceError("Cytoscape Navigator depends on jQuery >=1.4");if(!e)throw new ReferenceError("Cytoscape Navigator depends on Cytoscape >= 2.2");if(!t.fn.cytoscape)throw new ReferenceError("In order to use this library Cytoscape must have registered jQuery");var i=function(t,e){this._init(t,e)};i.prototype={constructor:i,_init:function(e,i){var o=this;this.$element=t(e),this.options=t.extend(!0,{},t.fn.cytoscapeNavigator.defaults,i),this.$element.cytoscape(function(){o.cy=o.$element.cytoscape("get"),o.boundingBox=o.cy.elements().boundingBox(),o._initPanel(),o._initThumbnail(),o._initView(),o._initOverlay()}),this.width=this.$element.width(),this.height=this.$element.height()},destroy:function(){this.options.container&&!this.options.removeCustomContainer?this.$panel.empty():this.$panel.remove(),this.$element.removeData("navigator")},_initPanel:function(){var e=this.options;if(e.container)if(e.container instanceof jQuery){if(!(e.container.length>0))return void t.error("Container for jquery.cyNavigator is empty");this.$panel=e.container.first()}else{if(!(t(e.container).length>0))return void t.error("There is no any element matching your selector for jquery.cyNavigator");this.$panel=t(e.container).first()}else this.$panel=t('<div class="cytoscape-navigator"/>'),t("body").append(this.$panel);this._setupPanel(),this.cy.on("resize",t.proxy(this.resize,this))},_setupPanel:function(){this.options;this.panelWidth=this.$panel.width(),this.panelHeight=this.$panel.height()},_initThumbnail:function(){this.$thumbnail=t("<canvas/>"),this.$panel.append(this.$thumbnail),this._setupThumbnailSizes(),this._setupThumbnail(),this.cy.on("initrender",t.proxy(this._checkThumbnailSizesAndUpdate,this)),this.options.thumbnailLiveFramerate===!1?this._hookGraphUpdates():this._setGraphUpdatesTimer()},_setupThumbnail:function(){this._thumbnailSetup||(this.$thumbnail.attr("width",this.panelWidth),this.$thumbnail.attr("height",this.panelHeight),this._thumbnailSetup=!0),this._updateThumbnailImage()},_setupThumbnailSizes:function(){this.boundingBox=this.cy.elements().boundingBox(),this.thumbnailZoom=Math.min(this.panelHeight/this.boundingBox.h,this.panelWidth/this.boundingBox.w),this.thumbnailPan={x:(this.panelWidth-this.thumbnailZoom*(this.boundingBox.x1+this.boundingBox.x2))/2,y:(this.panelHeight-this.thumbnailZoom*(this.boundingBox.y1+this.boundingBox.y2))/2}},_checkThumbnailSizesAndUpdate:function(){var t=this.thumbnailZoom,e=this.thumbnailPan.x,i=this.thumbnailPan.y;this._setupThumbnailSizes(),t!==this.thumbnailZoom||e!==this.thumbnailPan.x||i!==this.thumbnailPan.y?(this._setupThumbnail(),this._setupView()):this._updateThumbnailImage()},_initView:function(){var e=this;e.$view=t('<div class="cytoscape-navigatorView"/>'),e.$panel.append(this.$view),e.viewBorderTop=parseInt(this.$view.css("border-top-width"),10),e.viewBorderRight=parseInt(this.$view.css("border-right-width"),10),e.viewBorderBottom=parseInt(this.$view.css("border-bottom-width"),10),e.viewBorderLeft=parseInt(this.$view.css("border-left-width"),10),e.viewBorderHorizontal=this.viewBorderLeft+this.viewBorderRight,e.viewBorderVertical=this.viewBorderTop+this.viewBorderBottom,e._setupView(),e.cy.on("zoom pan",t.proxy(this._setupView,this))},_setupView:function(){if(!this.viewLocked){var t=this.cy.zoom(),e=this.cy.pan();this.viewW=this.width/t*this.thumbnailZoom,this.viewX=-e.x*this.viewW/this.width+this.thumbnailPan.x-this.viewBorderLeft,this.viewH=this.height/t*this.thumbnailZoom,this.viewY=-e.y*this.viewH/this.height+this.thumbnailPan.y-this.viewBorderTop,this.$view.width(this.viewW).height(this.viewH).css({left:this.viewX,top:this.viewY})}},_initOverlay:function(){this.$overlay=t('<div class="cytoscape-navigatorOverlay"/>'),this.$panel.append(this.$overlay),this.overlayHookPointX=0,this.overlayHookPointY=0,this._initEventsHandling()},resize:function(){this.width=this.$element.width(),this.height=this.$element.height(),this._thumbnailSetup=!1,this._setupPanel(),this._checkThumbnailSizesAndUpdate(),this._setupView()},_initEventsHandling:function(){var e=this,i=["mousedown","mousewheel","DOMMouseScroll","touchstart"],o=["mouseup","mouseout","mousemove","touchmove","touchend"];this.$overlay.on(i.join(" "),function(i){if("touchstart"===i.type&&(i.offsetX=e.viewX+e.viewW/2,i.offsetY=e.viewY+e.viewH/2),void 0===i.offsetX||void 0===i.offsetY){var o=t(i.target).offset();i.offsetX=i.pageX-o.left,i.offsetY=i.pageY-o.top}return"mousedown"===i.type||"touchstart"===i.type?e._eventMoveStart(i):"mousewheel"!==i.type&&"DOMMouseScroll"!==i.type||e._eventZoom(i),!1}),t(window).on(o.join(" "),function(i){if(e.overlayInMovement){if("touchend"===i.type?(i.offsetX=e.viewX+e.viewW/2,i.offsetY=e.viewY+e.viewH/2):"touchmove"===i.type&&(i.pageX=i.originalEvent.touches[0].pageX,i.pageY=i.originalEvent.touches[0].pageY),void 0===i.offsetX||void 0===i.offsetY){var o=t(i.target).offset();i.offsetX=i.pageX-o.left,i.offsetY=i.pageY-o.top}if(i.target!==e.$overlay[0]){var o=t(i.target).offset(),n=e.$overlay.offset();i.offsetX=i.offsetX-n.left+o.left,i.offsetY=i.offsetY-n.top+o.top}return"mousemove"===i.type||"touchmove"===i.type?e._eventMove(i):"mouseup"!==i.type&&"touchend"!==i.type||e._eventMoveEnd(i),!1}})},_eventMoveStart:function(t){var e=(new Date).getTime();this.overlayLastMoveStartTime&&this.overlayLastMoveStartTime+this.options.dblClickDelay>e?(this.overlayLastMoveStartTime=0,this.overlayInMovement=!0,this.overlayHookPointX=this.viewW/2,this.overlayHookPointY=this.viewH/2,this.options.viewLiveFramerate!==!1?this._eventMove({offsetX:this.panelWidth/2,offsetY:this.panelHeight/2}):this._eventMoveEnd({offsetX:this.panelWidth/2,offsetY:this.panelHeight/2}),this.overlayInMovement=!1):(this.overlayLastMoveStartTime=e,this.overlayInMovement=!0,this.viewLocked=!0,t.offsetX>=this.viewX&&t.offsetX<=this.viewX+this.viewW&&t.offsetY>=this.viewY&&t.offsetY<=this.viewY+this.viewH?(this.overlayHookPointX=t.offsetX-this.viewX,this.overlayHookPointY=t.offsetY-this.viewY):(this.overlayHookPointX=this.viewW/2,this.overlayHookPointY=this.viewH/2,this._eventMove(t)))},_eventMove:function(t){var e=this;this._checkMousePosition(t),this.overlayInMovement&&(this.viewX=t.offsetX-this.overlayHookPointX,this.viewY=t.offsetY-this.overlayHookPointY,this.$view.css("left",this.viewX),this.$view.css("top",this.viewY),this.options.viewLiveFramerate!==!1&&(0===this.options.viewLiveFramerate?this._moveCy():this.overlayTimeout||(this.overlayTimeout=setTimeout(function(){e._moveCy(),e.overlayTimeout=!1},1e3/this.options.viewLiveFramerate))))},_checkMousePosition:function(t){t.offsetX>this.viewX&&t.offsetX<this.viewX+this.viewBorderHorizontal+this.viewW&&t.offsetY>this.viewY&&t.offsetY<this.viewY+this.viewBorderVertical+this.viewH?this.$panel.addClass("mouseover-view"):this.$panel.removeClass("mouseover-view")},_eventMoveEnd:function(t){this.viewLocked=!1,this.$panel.removeClass("mouseover-view"),this.overlayInMovement&&(this._eventMove(t),this.options.viewLiveFramerate===!1&&this._moveCy(),this.overlayInMovement=!1)},_eventZoom:function(t){var e=Math.pow(10,t.originalEvent.wheelDeltaY/1e3||t.originalEvent.wheelDelta/1e3||t.originalEvent.detail/-32),i={left:t.offsetX,top:t.offsetY};this.cy.zoomingEnabled()&&this._zoomCy(e,i)},_hookGraphUpdates:function(){this.cy.on("position add remove data style",t.proxy(this._checkThumbnailSizesAndUpdate,this,!1))},_setGraphUpdatesTimer:function(){var t=1e3/this.options.thumbnailLiveFramerate,e=this,i=function(){setTimeout(function(){e._checkThumbnailSizesAndUpdate(!0),i()},t)};i()},_updateThumbnailImage:function(t){var e=this;if(!this._thumbnailUpdating){this._thumbnailUpdating=!0;var i=window?window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame:null;i=i||function(t){t&&setTimeout(t,1e3/60)};var o=function(t){i(t)},n=function(){var t=e.$thumbnail[0],i=t.getContext("2d"),s=e.panelWidth,h=e.panelHeight,a=e.boundingBox,r=Math.min(s/a.w,h/a.h),v=1,l={x:(s-r*(a.x1+a.x2))/2,y:(h-r*(a.y1+a.y2))/2};i.setTransform(1,0,0,1,0,0),i.clearRect(0,0,s,h),e.cy.renderTo(i,r,l,v),o(n)};o(n)}},_moveCy:function(){this.cy.pan({x:-(this.viewX+this.viewBorderLeft-this.thumbnailPan.x)*this.width/this.viewW,y:-(this.viewY+this.viewBorderLeft-this.thumbnailPan.y)*this.height/this.viewH})},_zoomCy:function(t,e){var i;i={x:this.width/2,y:this.height/2},this.cy.zoom({level:this.cy.zoom()*t,renderedPosition:i})}},t.fn.cytoscapeNavigator=function(e){var o=arguments;return this.each(function(){var n=t(this),s=n.data("navigator"),h="object"==typeof e&&e;s||n.data("navigator",s=new i(this,h)),"string"==typeof e&&(void 0===s[e]?t.error("cyNavigator has no such method"):"function"!=typeof s[e]?t.error("cyNavigator."+e+" is not a function"):"_"==e.charAt(0)?t.error("cyNavigator."+e+" is a private function"):s[e].call(s,Array.prototype.slice.call(o,1)))})},t.fn.cytoscapeNavigator.Constructor=i,t.fn.cytoscapeNavigator.defaults={container:!1,viewLiveFramerate:0,thumbnailEventFramerate:30,thumbnailLiveFramerate:!1,dblClickDelay:200,removeCustomContainer:!0},t.fn.cyNavigator=t.fn.cytoscapeNavigator,e("core","navigator",function(e){var i=this;t(i.container()).cytoscapeNavigator(e)})}t.exports=e}()}])});